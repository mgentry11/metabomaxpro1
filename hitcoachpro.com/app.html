<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="HIT Coach Pro">
    <title>HIT Coach Pro - Voice-Guided Strength Training</title>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/icon-180.png">
    <link rel="stylesheet" href="css/ios-app.css">
    <!-- QR Code Library -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
</head>
<body class="desktop-layout">
    <!-- Desktop Marketing Wrapper -->
    <div class="page-wrapper">
        <!-- Left Side - Description -->
        <aside class="app-description">
            <div class="description-content">
                <div class="app-logo">
                    <span class="logo-badge-lg">HCP</span>
                    <h1>HIT Coach Pro</h1>
                </div>
                <p class="tagline">Voice-Guided High Intensity Training</p>

                <div class="feature-list">
                    <div class="feature">
                        <div class="feature-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.91-3c-.49 0-.9.36-.98.85C16.52 14.2 14.47 16 12 16s-4.52-1.8-4.93-4.15c-.08-.49-.49-.85-.98-.85-.61 0-1.09.54-1 1.14.49 3 2.89 5.35 5.91 5.78V20c0 .55.45 1 1 1s1-.45 1-1v-2.08c3.02-.43 5.42-2.78 5.91-5.78.1-.6-.39-1.14-1-1.14z"/>
                            </svg>
                        </div>
                        <div class="feature-text">
                            <strong>Voice Coaching</strong>
                            <span>Professional audio cues guide every rep</span>
                        </div>
                    </div>
                    <div class="feature">
                        <div class="feature-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/>
                            </svg>
                        </div>
                        <div class="feature-text">
                            <strong>Precise Timing</strong>
                            <span>Eccentric, concentric & final negative phases</span>
                        </div>
                    </div>
                    <div class="feature">
                        <div class="feature-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"/>
                            </svg>
                        </div>
                        <div class="feature-text">
                            <strong>Gym Ready</strong>
                            <span>Full audio countdown - no screen watching</span>
                        </div>
                    </div>
                    <div class="feature">
                        <div class="feature-icon">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M17 1.01L7 1c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-1.99-2-1.99zM17 19H7V5h10v14z"/>
                            </svg>
                        </div>
                        <div class="feature-text">
                            <strong>Works Anywhere</strong>
                            <span>Web app - no download required</span>
                        </div>
                    </div>
                </div>

                <div class="protocol-info">
                    <h3>Built for HIT Protocols</h3>
                    <p>Based on proven high-intensity training methods including Dr. Ellington Darden's 30-10-30 technique. One set to failure, maximum results.</p>
                </div>

                <div class="cta-section">
                    <button class="cta-btn install-btn" id="install-btn" style="display: none;">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
                        </svg>
                        Install App
                    </button>
                    <a href="#" class="cta-btn try-btn" onclick="tryTheApp(); return false;">
                        Try the App
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                        </svg>
                    </a>
                    <p class="cta-hint">Free to use - Select "Commander" voice for pro audio</p>
                    <p class="ios-hint" id="ios-hint" style="display: none;">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M18.71 19.5c-.83 1.24-1.71 2.45-3.05 2.47-1.34.03-1.77-.79-3.29-.79-1.53 0-2 .77-3.27.82-1.31.05-2.3-1.32-3.14-2.53C4.25 17 2.94 12.45 4.7 9.39c.87-1.52 2.43-2.48 4.12-2.51 1.28-.02 2.5.87 3.29.87.78 0 2.26-1.07 3.81-.91.65.03 2.47.26 3.64 1.98-.09.06-2.17 1.28-2.15 3.81.03 3.02 2.65 4.03 2.68 4.04-.03.07-.42 1.44-1.38 2.83M13 3.5c.73-.83 1.94-1.46 2.94-1.5.13 1.17-.34 2.35-1.04 3.19-.69.85-1.83 1.51-2.95 1.42-.15-1.15.41-2.35 1.05-3.11z"/>
                        </svg>
                        iOS: Tap Share then "Add to Home Screen"
                    </p>
                </div>
            </div>
        </aside>

        <!-- Right Side - iPhone Mockup -->
        <main class="app-container">
            <div class="iphone-frame">
                <div class="iphone-notch"></div>
                <div id="app">
                    <!-- Main Workouts View -->
                    <div id="workouts-view" class="view active">
                        <!-- Header -->
                        <header class="header">
                            <button class="icon-btn" id="profile-btn">
                                <svg width="22" height="22" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/>
                                </svg>
                            </button>
                            <div class="profile-switcher" id="profile-switcher">
                                <button class="profile-toggle active" data-profile="0" id="profile-0">P1</button>
                                <button class="profile-toggle" data-profile="1" id="profile-1">P2</button>
                            </div>
                            <button class="icon-btn" id="settings-btn">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/>
                                </svg>
                            </button>
                        </header>

                        <!-- Workout Picker -->
                        <div class="workout-picker">
                            <button class="picker-btn active" data-workout="A">Workout A</button>
                            <button class="picker-btn" data-workout="B">Workout B</button>
                        </div>

                        <!-- Progress Bar -->
                        <div class="progress-bar">
                            <div class="progress-info">
                                <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M5 9.2h3V19H5V9.2zM10.6 5h2.8v14h-2.8V5zm5.6 8H19v6h-2.8v-6z"/>
                                </svg>
                                <span id="progress-text">0/8 Completed</span>
                            </div>
                            <div style="display: flex; gap: 6px;">
                                <button class="siri-btn" id="siri-btn" style="background: linear-gradient(135deg, #10b981, #22c55e); padding: 6px 12px;">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>
                                        <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>
                                    </svg>
                                    Siri Setup
                                </button>
                                <button class="sync-btn" id="sync-btn">
                                    <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M3 11h8V3H3v8zm2-6h4v4H5V5zm8-2v8h8V3h-8zm6 6h-4V5h4v4zM3 21h8v-8H3v8zm2-6h4v4H5v-4z"/>
                                    </svg>
                                    <span>Sync</span>
                                </button>
                            </div>
                        </div>

                        <!-- Exercise List -->
                        <div class="exercise-list" id="exercise-list">
                            <!-- Exercises populated by JS -->
                        </div>

                        <!-- Add Exercise -->
                        <button class="add-exercise-btn" id="add-exercise-btn">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"/>
                            </svg>
                            <span>Add Exercise</span>
                        </button>
                    </div>

                    <!-- Timer View -->
                    <div id="timer-view" class="view">
                        <div class="timer-container">
                            <header class="timer-header">
                                <button class="icon-btn close-btn" id="close-timer">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                                    </svg>
                                </button>
                                <span class="exercise-name" id="timer-exercise-name">Exercise</span>
                                <div style="width: 24px"></div>
                            </header>

                            <!-- Phase Indicators -->
                            <div class="phase-indicators">
                                <div class="phase-circle" id="phase-e">E</div>
                                <div class="phase-connector"></div>
                                <div class="phase-circle" id="phase-c">C</div>
                                <div class="phase-connector"></div>
                                <div class="phase-circle" id="phase-f">F</div>
                            </div>

                            <!-- Timer Display -->
                            <div class="timer-display" id="timer-display">30</div>
                            <div class="phase-label" id="phase-label">Get Ready</div>

                            <!-- Controls -->
                            <div class="timer-controls">
                                <button class="control-btn secondary" id="reset-btn">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
                                    </svg>
                                </button>
                                <button class="control-btn primary" id="play-pause-btn">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" id="play-icon">
                                        <path d="M8 5v14l11-7z"/>
                                    </svg>
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" id="pause-icon" style="display: none;">
                                        <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>
                                    </svg>
                                </button>
                                <button class="control-btn secondary" id="skip-btn">
                                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M4 18l8.5-6L4 6v12zm9-12v12l8.5-6L13 6z"/>
                                    </svg>
                                </button>
                            </div>

                            <!-- Voice Commands Hint -->
                            <div class="voice-hints" id="voice-hints">
                                <div class="voice-hint-title">ðŸŽ¤ Voice Commands Active</div>
                                <div class="voice-hint-commands">
                                    Say: <strong>"START"</strong> Â· <strong>"PAUSE"</strong> Â· <strong>"SKIP"</strong>
                                </div>
                            </div>

                            <!-- Complete Buttons -->
                            <div class="complete-buttons" id="complete-buttons" style="display: none;">
                                <button class="btn-primary" id="start-rest-btn">Start Rest</button>
                                <button class="btn-outline" id="another-set-btn">Another Set</button>
                            </div>
                        </div>
                    </div>

                    <!-- Rest Timer View -->
                    <div id="rest-view" class="view">
                        <div class="rest-container">
                            <header class="timer-header">
                                <button class="icon-btn close-btn" id="close-rest">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
                                    </svg>
                                </button>
                                <span class="rest-title">Rest</span>
                                <div style="width: 24px"></div>
                            </header>

                            <div class="rest-display" id="rest-display">90</div>
                            <div class="rest-label">seconds</div>

                            <div class="next-exercise">
                                <span class="next-label">Next:</span>
                                <span class="next-name" id="next-exercise-name">Pulldown</span>
                            </div>

                            <div class="rest-controls">
                                <button class="btn-outline" id="skip-rest-btn">Skip</button>
                            </div>
                        </div>
                    </div>

                    <!-- Stats View -->
                    <div id="stats-view" class="view">
                        <div class="stats-container">
                            <header class="stats-header">
                                <h2>Your Stats</h2>
                            </header>
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-value" id="stat-workouts">0</div>
                                    <div class="stat-label">Workouts</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value" id="stat-exercises">0</div>
                                    <div class="stat-label">Exercises</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value" id="stat-streak">0</div>
                                    <div class="stat-label">Day Streak</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-value" id="stat-thisweek">0</div>
                                    <div class="stat-label">This Week</div>
                                </div>
                            </div>
                            <div class="stats-summary">
                                <h3>Recent Activity</h3>
                                <div id="recent-activity">
                                    <p class="no-data">Complete workouts to see stats</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Log View -->
                    <div id="log-view" class="view">
                        <div class="log-container">
                            <header class="log-header">
                                <h2>Workout Log</h2>
                            </header>
                            <div class="log-list" id="log-list">
                                <p class="no-data">No workouts logged yet</p>
                            </div>
                        </div>
                    </div>

                    <!-- Tab Bar -->
                    <nav class="tab-bar">
                        <button class="tab active" data-tab="workouts">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"/>
                            </svg>
                            <span>Workouts</span>
                        </button>
                        <button class="tab" data-tab="analytics">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M3.5 18.49l6-6.01 4 4L22 6.92l-1.41-1.41-7.09 7.97-4-4L2 16.99z"/>
                            </svg>
                            <span>Stats</span>
                        </button>
                        <button class="tab" data-tab="history">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/>
                            </svg>
                            <span>Log</span>
                        </button>
                    </nav>
                </div>
                <div class="iphone-home-bar"></div>
            </div>
        </main>
    </div>

    <!-- Modals (outside the frame) -->
    <div id="log-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Log Weight</h3>
                <p id="modal-exercise-name">Exercise Name</p>
            </div>
            <div class="modal-body">
                <label>Weight (lbs)</label>
                <input type="number" id="weight-input" placeholder="0" inputmode="decimal">
                <div class="failure-toggle">
                    <label class="toggle-label">
                        <input type="checkbox" id="failure-checkbox">
                        <span class="toggle-text">Reached Failure</span>
                    </label>
                </div>
                <!-- Add to Siri button for this exercise -->
                <button id="add-siri-exercise-btn" onclick="addExerciseToSiri()" style="width: 100%; margin-top: 16px; padding: 12px; background: linear-gradient(135deg, #06b6d4, #3b82f6); border: none; border-radius: 8px; color: white; font-size: 13px; font-weight: 600; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 6px;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="white">
                        <path d="M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3z"/>
                        <path d="M17 11c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z"/>
                    </svg>
                    <span id="siri-btn-text">Add to Siri</span>
                </button>
            </div>
            <div class="modal-actions">
                <button class="btn-cancel" id="cancel-log">Cancel</button>
                <button class="btn-save" id="save-log">Save</button>
            </div>
        </div>
    </div>

    <div id="sync-modal" class="modal">
        <div class="modal-content sync-content">
            <div class="modal-header">
                <h3>Sync to iPhone</h3>
                <p>Scan with HIT Coach Pro iOS app</p>
            </div>
            <div class="qr-container">
                <canvas id="qr-canvas"></canvas>
            </div>
            <div class="modal-actions">
                <button class="btn-save" id="close-sync">Done</button>
            </div>
        </div>
    </div>

    <div id="settings-modal" class="modal">
        <div class="modal-content settings-content">
            <div class="modal-header">
                <h3>Settings</h3>
                <button id="close-settings" class="btn-done">Done</button>
            </div>
            <div class="settings-body">
                <div class="settings-group">
                    <div class="settings-group-header">Appearance</div>
                    <div class="segmented-control" id="appearance-control">
                        <button class="seg-btn" data-value="system">System</button>
                        <button class="seg-btn active" data-value="dark">Dark</button>
                        <button class="seg-btn" data-value="light">Light</button>
                    </div>
                </div>
                <div class="settings-group">
                    <div class="settings-group-header">Voice Options</div>
                    <div class="settings-item-label">Standard Voices</div>
                    <div class="voice-options" id="voice-control">
                        <button class="voice-btn active" data-value="male">M</button>
                        <button class="voice-btn" data-value="female">F</button>
                        <button class="voice-btn" data-value="digital">D</button>
                    </div>
                    <div class="settings-item-label">Pro Voices</div>
                     <button class="voice-btn pro" data-value="commander">
                        <span class="pro-badge">PRO</span>
                        Commander
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Profile Modal -->
    <div id="profile-modal" class="modal">
        <div class="modal-content settings-content">
            <div class="modal-header">
                <h3>Your Profile</h3>
                <button id="close-profile" class="btn-done">Done</button>
            </div>
            <div class="settings-body">
                <div class="settings-group">
                    <div class="settings-group-header">Personal Info</div>
                    <div class="settings-item">
                       <input type="text" id="profile-name" class="text-input" placeholder="Enter your name">
                    </div>
                </div>
                <div class="settings-group">
                    <div class="settings-group-header">Physical Stats</div>
                    <div class="settings-item">
                        <label>Age</label>
                        <input type="number" id="profile-age" class="text-input-right" placeholder="0">
                    </div>
                     <div class="settings-item">
                        <label>Weight</label>
                        <input type="number" id="profile-weight" class="text-input-right" placeholder="0">
                    </div>
                </div>
                 <div class="settings-group">
                    <div class="settings-group-header">Data</div>
                    <button class="btn-danger" id="reset-data-btn">Reset All Data</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Siri Setup Modal - Per-Exercise Shortcuts -->
    <div id="siri-modal" class="modal">
        <div class="modal-content siri-content" style="max-width: 400px; max-height: 85vh;">
            <div class="modal-header" style="padding-bottom: 8px;">
                <h3 style="margin: 0; font-size: 18px;">Set Up Siri Voice Control</h3>
            </div>
            <div class="siri-body" style="padding: 12px 16px; overflow-y: auto; max-height: 60vh;">
                <div style="background: rgba(16, 185, 129, 0.1); border-radius: 10px; padding: 12px; margin-bottom: 16px; font-size: 12px; color: var(--text-secondary);">
                    <div style="font-weight: 600; color: #10b981; margin-bottom: 8px;">Tap "Add" for any exercise:</div>
                    <div>1. URL copies automatically</div>
                    <div>2. Shortcuts app opens</div>
                    <div>3. Tap + â†’ Add Action â†’ "Open URL"</div>
                    <div>4. Paste â†’ Name it â†’ Done</div>
                </div>
                <div id="siri-exercise-list" style="display: flex; flex-direction: column; gap: 8px;">
                    <!-- Populated by JS -->
                </div>
            </div>
            <div class="modal-actions" style="padding: 12px 16px;">
                <button class="btn-save" id="close-siri">Done</button>
            </div>
        </div>
    </div>

    <script src="js/ios-app.js"></script>

    <!-- Try the App function -->
    <script>
        function tryTheApp() {
            // Scroll to the iPhone frame (useful on mobile)
            document.querySelector('.iphone-frame').scrollIntoView({behavior: 'smooth'});

            // Give a small delay for scroll, then start the first exercise
            setTimeout(() => {
                // Find the first exercise play button and click it
                const firstPlayBtn = document.querySelector('.exercise-card .start-btn');
                if (firstPlayBtn) {
                    // Add a brief highlight effect to show what's happening
                    const card = firstPlayBtn.closest('.exercise-card');
                    if (card) {
                        card.style.transition = 'transform 0.2s, box-shadow 0.2s';
                        card.style.transform = 'scale(1.02)';
                        card.style.boxShadow = '0 0 20px rgba(16, 185, 129, 0.5)';

                        setTimeout(() => {
                            card.style.transform = '';
                            card.style.boxShadow = '';
                            firstPlayBtn.click();
                        }, 300);
                    } else {
                        firstPlayBtn.click();
                    }
                }
            }, 400);
        }
    </script>

    <!-- PWA Installation Handler -->
    <script>
        // PWA Installation handling
        let deferredPrompt = null;
        const installBtn = document.getElementById('install-btn');
        const iosHint = document.getElementById('ios-hint');

        // Detect iOS
        const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;
        const isStandalone = window.matchMedia('(display-mode: standalone)').matches ||
                            window.navigator.standalone === true;

        // Show iOS instructions if on iOS and not already installed
        if (isIOS && !isStandalone) {
            iosHint.style.display = 'flex';
        }

        // Listen for the beforeinstallprompt event (Android/Chrome)
        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevent Chrome 67 and earlier from automatically showing the prompt
            e.preventDefault();
            // Stash the event so it can be triggered later
            deferredPrompt = e;
            // Show the install button
            installBtn.style.display = 'flex';
            console.log('PWA install prompt available');
        });

        // Handle install button click
        installBtn.addEventListener('click', async () => {
            if (!deferredPrompt) {
                // Fallback for browsers that don't support beforeinstallprompt
                alert('To install: Open browser menu and select "Add to Home Screen" or "Install App"');
                return;
            }

            // Show the install prompt
            deferredPrompt.prompt();

            // Wait for the user to respond to the prompt
            const { outcome } = await deferredPrompt.userChoice;
            console.log('User response to install prompt:', outcome);

            // Clear the deferred prompt variable
            deferredPrompt = null;

            // Hide the install button after prompt
            installBtn.style.display = 'none';
        });

        // Track successful installation
        window.addEventListener('appinstalled', () => {
            console.log('HIT Coach Pro was installed');
            deferredPrompt = null;
            installBtn.style.display = 'none';
            iosHint.style.display = 'none';
        });

        // Register service worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then((registration) => {
                        console.log('ServiceWorker registered:', registration.scope);

                        // Preload audio files for offline use
                        if (navigator.serviceWorker.controller) {
                            navigator.serviceWorker.controller.postMessage('preloadAudio');
                        }
                    })
                    .catch((error) => {
                        console.log('ServiceWorker registration failed:', error);
                    });
            });
        }
    </script>
</body>
</html>
